Loaded dependency [python3/3.8.11]: gcc/10.3.0-binutils-2.36.1
Loaded module: python3/3.8.11

Loading python3/3.8.11
  Loading requirement: gcc/10.3.0-binutils-2.36.1
Loaded module: cuda/11.3
Loaded module: cudnn/v8.2.0.53-prod-cuda-11.3
2022-03-10 12:43:13.405027: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
Traceback (most recent call last):
  File "main.py", line 219, in <module>
    preds, labels_oneh = test2()
  File "main.py", line 185, in test2
    for data in tqdm(test_loader):
  File "/zhome/c8/2/138418/.local/lib/python3.8/site-packages/tqdm/notebook.py", line 239, in __init__
    self.container = self.status_printer(self.fp, total, self.desc, self.ncols)
  File "/zhome/c8/2/138418/.local/lib/python3.8/site-packages/tqdm/notebook.py", line 112, in status_printer
    raise ImportError(
ImportError: IProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user_install.html
Exception ignored in: <function tqdm.__del__ at 0x7f880f249160>
Traceback (most recent call last):
  File "/zhome/c8/2/138418/.local/lib/python3.8/site-packages/tqdm/std.py", line 1145, in __del__
  File "/zhome/c8/2/138418/.local/lib/python3.8/site-packages/tqdm/notebook.py", line 283, in close
AttributeError: 'tqdm_notebook' object has no attribute 'disp'
Loaded dependency [python3/3.8.11]: gcc/10.3.0-binutils-2.36.1
Loaded module: python3/3.8.11

Loading python3/3.8.11
  Loading requirement: gcc/10.3.0-binutils-2.36.1
Loaded module: cuda/11.3
Loaded module: cudnn/v8.2.0.53-prod-cuda-11.3
2022-03-10 12:58:04.015186: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
Traceback (most recent call last):
  File "main.py", line 217, in <module>
    preds, labels_oneh = test2()
  File "main.py", line 186, in test2
    pred = model(images)
  File "/zhome/c8/2/138418/.local/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "main.py", line 61, in forward
    out = nn.Sequential(
  File "/zhome/c8/2/138418/.local/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/zhome/c8/2/138418/.local/lib/python3.8/site-packages/torch/nn/modules/container.py", line 141, in forward
    input = module(input)
  File "/zhome/c8/2/138418/.local/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/zhome/c8/2/138418/.local/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 446, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/zhome/c8/2/138418/.local/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 442, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
Loaded dependency [python3/3.8.11]: gcc/10.3.0-binutils-2.36.1
Loaded module: python3/3.8.11

Loading python3/3.8.11
  Loading requirement: gcc/10.3.0-binutils-2.36.1
Loaded module: cuda/11.3
Loaded module: cudnn/v8.2.0.53-prod-cuda-11.3
2022-03-10 13:08:33.570532: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
Traceback (most recent call last):
  File "main.py", line 217, in <module>
    preds, labels_oneh = test2()
  File "main.py", line 186, in test2
    pred = model(images)
  File "/zhome/c8/2/138418/.local/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "main.py", line 61, in forward
    out = nn.Sequential(
  File "/zhome/c8/2/138418/.local/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/zhome/c8/2/138418/.local/lib/python3.8/site-packages/torch/nn/modules/container.py", line 141, in forward
    input = module(input)
  File "/zhome/c8/2/138418/.local/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/zhome/c8/2/138418/.local/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 446, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/zhome/c8/2/138418/.local/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 442, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
Loaded dependency [python3/3.8.11]: gcc/10.3.0-binutils-2.36.1
Loaded module: python3/3.8.11

Loading python3/3.8.11
  Loading requirement: gcc/10.3.0-binutils-2.36.1
Loaded module: cuda/11.3
Loaded module: cudnn/v8.2.0.53-prod-cuda-11.3
2022-03-10 13:18:35.487196: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
Traceback (most recent call last):
  File "main.py", line 218, in <module>
    preds, labels_oneh = test2()
  File "main.py", line 197, in test2
    pred = pred.cuda().detach().numpy()
TypeError: can't convert cuda:0 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
Loaded dependency [python3/3.8.11]: gcc/10.3.0-binutils-2.36.1
Loaded module: python3/3.8.11

Loading python3/3.8.11
  Loading requirement: gcc/10.3.0-binutils-2.36.1
Loaded module: cuda/11.3
Loaded module: cudnn/v8.2.0.53-prod-cuda-11.3
2022-03-10 13:25:35.694701: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
Loaded dependency [python3/3.8.11]: gcc/10.3.0-binutils-2.36.1
Loaded module: python3/3.8.11

Loading python3/3.8.11
  Loading requirement: gcc/10.3.0-binutils-2.36.1
Loaded module: cuda/11.3
Loaded module: cudnn/v8.2.0.53-prod-cuda-11.3
2022-03-10 13:39:14.335560: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
Traceback (most recent call last):
  File "main.py", line 321, in <module>
    logits_list.append(model(images))
  File "/zhome/c8/2/138418/.local/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "main.py", line 62, in forward
    out = nn.Sequential(
  File "/zhome/c8/2/138418/.local/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/zhome/c8/2/138418/.local/lib/python3.8/site-packages/torch/nn/modules/container.py", line 141, in forward
    input = module(input)
  File "/zhome/c8/2/138418/.local/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/zhome/c8/2/138418/.local/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 446, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/zhome/c8/2/138418/.local/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 442, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
Loaded dependency [python3/3.8.11]: gcc/10.3.0-binutils-2.36.1
Loaded module: python3/3.8.11

Loading python3/3.8.11
  Loading requirement: gcc/10.3.0-binutils-2.36.1
Loaded module: cuda/11.3
Loaded module: cudnn/v8.2.0.53-prod-cuda-11.3
2022-03-10 13:46:47.112930: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
Traceback (most recent call last):
  File "main.py", line 350, in <module>
    preds_calibrated, _ = test2(T_scaling, temperature=temperature)
  File "main.py", line 191, in test2
    pred = calibration_method(pred, kwargs)
  File "main.py", line 301, in T_scaling
    return torch.div(logits, temperature)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!
Loaded dependency [python3/3.8.11]: gcc/10.3.0-binutils-2.36.1
Loaded module: python3/3.8.11

Loading python3/3.8.11
  Loading requirement: gcc/10.3.0-binutils-2.36.1
Loaded module: cuda/11.3
Loaded module: cudnn/v8.2.0.53-prod-cuda-11.3
2022-03-10 13:56:00.184493: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
Loaded dependency [python3/3.8.11]: gcc/10.3.0-binutils-2.36.1
Loaded module: python3/3.8.11

Loading python3/3.8.11
  Loading requirement: gcc/10.3.0-binutils-2.36.1
Loaded module: cuda/11.3
Loaded module: cudnn/v8.2.0.53-prod-cuda-11.3
Traceback (most recent call last):
  File "main.py", line 304, in <module>
    draw_reliability_graph(preds_original,"soft_")
  File "/zhome/f5/b/137886/Avanced_machine_learning/Classification-With-Laplace-Approximation/visualization/plot.py", line 37, in draw_reliability_graph
    ECE, MCE = get_metrics(preds)
  File "/zhome/f5/b/137886/Avanced_machine_learning/Classification-With-Laplace-Approximation/visualization/plot.py", line 27, in get_metrics
    bins, _, bin_accs, bin_confs, bin_sizes = calc_bins(preds)
  File "/zhome/f5/b/137886/Avanced_machine_learning/Classification-With-Laplace-Approximation/visualization/plot.py", line 19, in calc_bins
    bin_accs[bin] = (labels_oneh[binned==bin]).sum() / bin_sizes[bin]
NameError: name 'labels_oneh' is not defined
